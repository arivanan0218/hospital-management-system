/* Mobile keyboard fixes for the chat interface */

/* Basic styles for all screen sizes */
.chat-input-container, 
.chat-messages-container {
  -webkit-transform: translateZ(0);
  transform: translateZ(0);
  will-change: transform;
}

/* Special class for smoother transitions when keyboard opens/closes */
.input-transition-active {
  transition: none !important; /* Disable transitions when keyboard is active */
}

/* Prevent input from moving around */
.keyboard-open.chat-input-container {
  position: fixed !important;
  bottom: 0 !important;
  z-index: 9999 !important;
  animation: none !important;
  transition: none !important;
}

@media (max-width: 768px) {
  /* Prevent content from being hidden behind keyboard */
  .hospital-chat-container {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    width: 100%;
    height: 100%;
  }
  
  /* Fix for content when keyboard is open */
  .chat-messages-container {
    padding-bottom: 80px; /* Ensure enough space at bottom */
  }
  
  /* Ensure input is always visible and anchored at the bottom */
  .chat-input-container {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background-color: #1a1a1a;
    /* Remove transition for position to prevent jumping */
    transition: bottom 0.05s ease-out;
    z-index: 50 !important; /* Higher z-index to ensure it's always on top */
    transform: translateZ(0); /* Force hardware acceleration */
  }
  
  /* Fix for keyboard open state */
  body.no-scroll .chat-input-container {
    position: fixed !important; /* Keep fixed to maintain consistent positioning */
    width: 100%;
    bottom: 0 !important; /* Always stick to visual viewport bottom */
  }
  
  /* Fix for iOS devices */
  .mobile-chat-input {
    font-size: 16px !important; /* Prevent auto zoom on iOS */
  }
  
  /* Fix for body scroll issues */
  body.no-scroll {
    position: fixed;
    overflow: hidden;
    width: 100%;
    height: calc(var(--vh, 1vh) * 100);
  }
  
  /* Fix for iOS viewport height issues */
  @supports (-webkit-touch-callout: none) {
    .hospital-chat-container {
      height: -webkit-fill-available;
      max-height: -webkit-fill-available;
    }
  }

  /* Prevent scrolling when keyboard is open */
  body.no-scroll {
    overflow: hidden;
    position: fixed;
    width: 100%;
    height: 100%;
  }
  
  /* Remove any duplicate containers that might be created */
  .mobile-input-wrapper + .mobile-input-wrapper {
    display: none !important;
  }
  
  /* Better keyboard handling */
  .chat-input-container.keyboard-open {
    position: fixed !important;
    bottom: 0 !important;
    left: 0;
    right: 0;
    /* Make sure this takes highest precedence */
    z-index: 9999 !important;
  }
  
  /* Force hardware acceleration to prevent glitches */
  .chat-input-container {
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
    will-change: transform, bottom;
  }
  
  /* Ensure messages container doesn't overlap with input */
  .chat-messages-container {
    padding-bottom: 100px !important;
    margin-bottom: 0;
  }
  
  /* Fix for iOS keyboard issues */
  @supports (-webkit-touch-callout: none) {
    .chat-input-container.keyboard-open {
      /* Use viewport units instead of fixed pixel values */
      position: fixed !important;
      bottom: 0 !important;
    }
    
    /* Prevent content from shifting */
    .hospital-chat-container {
      overflow-y: auto;
    }
  }
}

/* Fix for scrolling issues when keyboard is open */
@media (max-height: 450px) and (max-width: 768px) {
  .chat-input-container {
    position: sticky;
    bottom: 0;
  }
}

/* Additional fixes for the input positioning */
.hospital-chat-container.keyboard-open .chat-messages-container {
  padding-bottom: 120px !important;
}

/* Ensure the input stays fixed at the bottom during animations */
.chat-input-container {
  transform: translateY(0) translateZ(0);
}

/* Prevent any animation or transition on the input when keyboard is open */
.chat-input-container.keyboard-open {
  transform: none !important;
  transition: none !important;
}
