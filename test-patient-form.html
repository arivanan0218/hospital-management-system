<!DOCTYPE html>
<html>
<head>
    <title>Test Patient Form Data Parsing</title>
</head>
<body>
    <h1>Patient Form Data Parsing Test</h1>
    <div id="result"></div>
    
    <script>
        // Simulate the response from the backend
        const mockResponse = {
            "success": true, 
            "agent": "patient", 
            "result": {
                "success": true, 
                "message": "Patient created successfully", 
                "data": {
                    "id": "a6d7483b-3582-4f4e-9681-b46dce1e11d6", 
                    "patient_number": "P704929", 
                    "first_name": "Alice", 
                    "last_name": "Johnson", 
                    "date_of_birth": "1985-03-15", 
                    "gender": "Female", 
                    "phone": "555-0199", 
                    "email": "alice.johnson@email.com", 
                    "address": "789 Oak Street", 
                    "emergency_contact_name": null, 
                    "emergency_contact_phone": null, 
                    "blood_type": null, 
                    "allergies": null, 
                    "medical_history": null, 
                    "created_at": "2025-08-20T15:45:28.949569", 
                    "updated_at": "2025-08-20T15:45:28.949569"
                }
            }
        };

        // Test the old parsing (should show "Unknown Unknown")
        const oldPatientData = mockResponse.data || {};
        const oldResult = `Old parsing (response.data): ${oldPatientData.first_name || 'Unknown'} ${oldPatientData.last_name || 'Unknown'}`;
        
        // Test the new parsing (should show "Alice Johnson")
        const newPatientData = mockResponse.result?.data || mockResponse.data || {};
        const newResult = `New parsing (response.result?.data || response.data): ${newPatientData.first_name || 'Unknown'} ${newPatientData.last_name || 'Unknown'}`;
        
        document.getElementById('result').innerHTML = `
            <h2>Results:</h2>
            <p><strong>${oldResult}</strong></p>
            <p><strong>${newResult}</strong></p>
            <h3>Full Patient Data:</h3>
            <pre>${JSON.stringify(newPatientData, null, 2)}</pre>
        `;
    </script>
</body>
</html>
